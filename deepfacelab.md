# DeepFaceLab

## Abstract

背景

> Deepfake defense not only requires the research of detection but also requires the efforts of generation methods. However, current deepfake methods suffer the effects of obscure workflow and poor performance. 
>
> Deepfake防御不仅需要检测的研究，还需要生成方法的努力。 然而，当前的 deepfake 方法受到工作流程模糊和性能不佳的影响。

 方法

> We demonstrate the advantage of our system by comparing our approach with other face-swapping methods.

结果

> It provides the necessary tools as well as an easy-to-use way to conduct high- quality face-swapping. It also offers a flexible and loose coupling structure for people who need to strengthen their pipeline with other features without writing complicated boilerplate code.
>
> 它提供了必要的工具以及一种易于使用的方式来进行高质量的换脸。 它为那些需要想通过其他特征强化他们的基线的人提供灵活且松散的耦合结构。

> It is noteworthy that DeepFaceLab could achieve cinema-quality results with high fidelity. 





## 1. Introduction 

### 背景介绍

> Since deep learning has empowered the realm of computer vision in recent years, manipulating digital images, especially the manipulation of human portrait images, has improved rapidly and achieved photorealistic results in most cases. Face swapping is an eye-catching task in generating fake content by transferring a source face to the destination while maintaining the destination’s facial movements and expression deformations.

> Numerous spoof videos synthesized by GAN-based face-swapping methods are published on YouTube and other video websites. Commercial mobile applications such as ZAO2 and FaceApp3 which allow general netizens to cre- ate fake images and videos effortlessly significantly boost the spreading of these swapping techniques, called deep- fake.

### 课题开展的原因

#### deepfake这项技术造成的影响

> These content generation and modification technologies may affect public discourse quality and infringe upon the citizens’ right of portrait, especially given that deepfake may be used maliciously as a source of misinformation, ma- nipulation, harassment, and persuasion. Identifying manip- ulated media is a technically demanding and rapidly evolving challenge that requires collaborations across the entire tech industry and beyond.

#### 这项课题开始的原因

> Research on media anti-forgery detection is being invigorated and dedicating growing efforts to forgery face detec- tion. DFDC is a typical example, a million-dollar competition launched by Facebook and Microsoft. **Training robust forgery detection models requires high-quality fake data.** Data generated by our methods are involved in the DFDC dataset.
>
> 媒体防伪检测的研究正在蓬勃发展，并且越来越多地致力于伪造人脸检测。 DFDC 就是一个典型的例子，Facebook 和微软发起的百万美元竞赛。 **训练强大的伪造检测模型需要高质量的假数据。** 我们的方法生成的数据包含在 DFDC 数据集中。



### 主要结果

![image-20210921105429405](C:\Users\lkw\AppData\Roaming\Typora\typora-user-images\image-20210921105429405.png)

### 结论

> The contributions of DeepFaceLab can be summarized as three-folds:
> • A state-of-the-art framework consists of a maturity pipeline is proposed, aiming to achieve photorealistic face-swapping results.
> • DeepFaceLab open-sourced the code in 2018 and always kept up to the progress in the computer vi- sion area, making a positive contribution for defending deepfake, which has drawn broad attention in the open-source community and VFX areas.
> • A series of high-efficiency components and tools are introduced in DeepFaceLab to build better face- swapping videos.

### 对于研发deepfake类工作一段政治正确的话术

> However, detection after being attacked is not the unique manner for reducing the malicious influence of deepfake. It is always too late to detect spreading spoofing content. In our perspective, for both academia and the general public, helping netizens know what deepfake is and how a cinema- quality swapped video is generated is much better. As the old saying goes:“The best defense is a good offense”. Making general netizens realize the existence of deepfake and strengthening their identification ability for spoof me- dia published in social networks is much more critical than agonizing the fact whether spoof media is true or not.
>
> 然而，被攻击后的检测并不是降低 deepfake 恶意影响的唯一方式。 检测正在传播的欺骗内容总是为时已晚。 在我们看来，无论是学术界还是公众，帮助网民了解什么是 deepfake 以及如何生成电影质量的交换视频会更好。 俗话说：“最好的防守是好的进攻”。 让广大网民意识到deepfake的存在，加强他们对社交网络上发布的恶搞媒体的识别能力，比苦恼恶搞媒体是否属实要重要得多。

## 2. Characteristics of DeepFaceLab DeepFaceLab’s

> DeepFaceLab’s success stems from weaving previous ideas into a design that balances speed and ease of use and the booming of computer vision in face recognition, align- ment, reconstruction, segmentation, etc. There are Four main characteristics behind our implementation:
>
> DeepFaceLab 的成功源于将先前的想法编织到一个设计中，该设计平衡了速度和易用性以及计算机视觉在人脸识别、对齐、重建、分割等方面的蓬勃发展。我们的实现背后有四个主要特征：

> **Convenience** DFL strives to make the usage of its pipeline, including data loader and processing, model training, and post-processing, as easy and productive as possible. Unlike other face swapping systems, DFL provides a complete command-line tool with every aspect of the pipeline that could be implemented in the way that users choose. Notably, the complexity inherent and many hand-picked features for fine-grained control such as the canonical face landmark for face alignment should be handled internally and hidden behind DFL. People could achieve the smooth and photorealistic face-swapping results without the need for hand-picked features if they follow the settings of the workflow, but only with the need of two videos: the source video (src) and the destination video (dst) without the re- quirement to pair the same facial expression between src and dst. To some extent, DFL could function as a point- and-shoot camera.
>
> DFL 努力使它流程的使用尽可能简单和高效，包括数据加载器和处理、模型训练和后处理。 与其他面部交换系统不同，DFL 提供了一个完整的命令行工具，可以按照用户选择的方式实现管道的各个方面。 值得注意的是，用于细粒度控制的固有复杂性和许多精心挑选的特征（例如用于人脸对齐的规范人脸地标）应在内部处理并隐藏在 DFL 之后。 如果按照工作流程的设置，人们可以在不需要手动选择特征的情况下获得流畅和逼真的换脸结果，但只需要两个视频：源视频 (src) 和目标视频 (dst) 无需在 src 和 dst 之间配对相同的面部表情。 在某种程度上，DFL 可以充当傻瓜相机。

> **Wide engineering support ** Some practical measures were added to improve the performance: multi-GPU sup- port, half-precision training, usage of pinned CUDA memory to improve throughput, use of multiple threads to accelerate graphics operations and data processing. Even a machine with 2GB VRAM can also conduct a successful face-swapping project.
> 添加了一些实际措施来提高性能：多 GPU 支持、半精度训练、使用固定 CUDA 内存来提高吞吐量、使用多线程来加速图形操作和数据处理。 即使是2GB显存的机器，也可以进行成功的换脸项目。

> **Extensibility** To strengthen the flexibility of DFL’s work- flow and attract the interests of the research community, users are free to replace any component of DFL that does not meet their requirements. Most of DFL’s modules are designed to be interchangeable. For instance, people could provide a newer face detector to achieve higher performance in detecting faces with extreme angles or outlying areas.
>
> 为了加强 DFL 工作流程的灵活性并吸引研究界的兴趣，用户可以自由更换 DFL 的任何不满足其要求的组件。 DFL 的大部分模块都设计为可互换的。 例如，人们可以提供更新的人脸检测器，以在检测具有极端角度或外围区域的人脸时获得更高的性能。

> **Scalability** Having good datasets is essential for the face-swapping task. Generally, the larger the datasets, the better the final results. However, results that are directly extracted from src and dst are always with noises, which significantly harm the final quality. In consideration of the complex situ- ations of input videos, DFL provides a series of measures to clean up datasets. With these measures, DFL has ro- bust scalability and can even support massive scale datasets and conduct cinema-quality face-swapping basing on large datasets.
>
> 可扩展性 拥有良好的数据集对于换脸任务至关重要。 通常，数据集越大，最终结果越好。 然而，直接从 src 和 dst 中提取的结果总是带有噪声，这会严重损害最终质量。 考虑到输入视频的复杂情况，DFL 提供了一系列清理数据集的措施。 通过这些措施，DFL 具有强大的可扩展性，甚至可以支持海量数据集，并基于大数据集进行电影质量的换脸。

## 3. Pipeline

> In DeepFaceLab (DFL for short), we can abstract the pipeline into three phases: extraction, training, and conversion. These three parts are presented sequen- tially. Besides, it is noteworthy that DFL falls in a typical one-to-one face-swapping paradigm, which means there are only two kinds of data: src and dst, the abbreviation for source and destination, are used in the following narrative.

### 3.1. Extraction

The extraction phase is the first phase in DFL, aiming to extract a face from src and dst data. This phase consists of many algorithms and processing parts, i.e., **face detection**, **face alignment**, and **face segmentation**. DFL provides many extraction modes (i.e, half-face, full-face, whole- face), which represents the face coverage area of the extrac- tion phase. Generally, we take full-face mode by default.
Face

**Face Detection** The first step in extraction phase is to find the target face in the given data: src and dst. DFL regards S3FD [24] as its default face detector. S3FD can be re- placed with other face detection algorithms painlessly, i.e RetinaFace [4].

## 6. Conclusions

作者通过哪些结果来得出了这个结论

> The rapidly evolving DeepFaceLab has become a popular face-swapping tool in the deep learning practitioner community by freeing people from laborious, complicated data processing, trivial detailed work in training, and con- version. As more and more people participate in the development of DeepFaceLab,  deepfake entertainment has been trending in social media. In the future, we want to dig deeper into the entertainment-related AI framework while pushing the forgery detection field forward.
>
> 快速发展的 DeepFaceLab 已成为深度学习从业者社区中流行的换脸工具，将人们从费力、复杂的数据处理、训练和转换中的琐碎细节工作中解放出来。 随着越来越多的人参与到 DeepFaceLab 的开发中，deepfake 娱乐已经成为社交媒体的趋势。 未来，我们希望在推动伪造检测领域向前发展的同时，更深入地挖掘与娱乐相关的人工智能框架。